<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rekap LTT Internal</title>

<style>
body{
  font-family: Arial, sans-serif;
  margin:10px;
  background:#f6f7f9;
}

.container{
  overflow-x:auto;
  background:white;
  border:1px solid #ddd;
  border-radius:6px;
}

table{
  border-collapse:collapse;
  table-layout:fixed;
  min-width:1300px;
}

th,td{
  border:1px solid #bbb;
  padding:6px;
  font-size:13px;
  text-align:center;
}

/* header besar */
.big-header{
  background:#f1f1f1;
  font-weight:700;
  font-size:14px;
}

/* kolom teks lebar */
td:first-child{
  text-align:left;
  width:220px;
}

/* kolom angka */
td:not(:first-child){
  width:85px;
}
</style>
</head>
<body>

<div class="container">
<table id="sheet"></table>
</div>

<script>
fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vTh8tWy51eqNOkC7loWc9vYT2HrPOboMrpD-EplUVVznhgHs5EYjCWVnWpiw02jqVzRY9TN64VWvaha/pub?gid=733937360&single=true&output=csv")
.then(res => res.text())
.then(data => {
  let rows = data.trim().split("\n").map(r => r.split(","))
  let html = ""

  // BARIS PERTAMA â†’ merge all columns
  let colCount = rows[0].length
  html += `<tr><th class="big-header" colspan="${colCount}">${rows[0][0]}</th></tr>`

  // BARIS KEDUA jadi header normal
  html += "<tr>"
  rows[1].forEach(c => html += `<th>${c}</th>`)
  html += "</tr>"

  // DATA
  for(let i=2;i<rows.length;i++){
    html += "<tr>"
    rows[i].forEach(c => html += `<td>${c}</td>`)
    html += "</tr>"
  }

  document.getElementById("sheet").innerHTML = html
})
</script>

</body>
</html>
